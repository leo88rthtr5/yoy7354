const tallasPorProducto={"AirMax Runner Pro":["22","22.5","23","23.5","24","24.5","25","25.5","26","26.5","27","27.5","28","28.5","29","29.5","30"],"Urban Flex 2023":["22","23","24","25","26","27","28","29","30"]},coloresPorProducto={"AirMax Runner Pro":["#2a2a72","#1e1e24","#ffa400"],"Urban Flex 2023":["#1e1e24","#6c757d","#f8f9fa"]},products=[{name:"AirMax Runner Pro",badge:"Nuevo",images:["https://images.unsplash.com/photo-1542291026-7eec264c27ff?auto=format&fit=crop&w=1350&q=80","https://images.unsplash.com/photo-1600269452121-4f2416e55c28?auto=format&fit=crop&w=1350&q=80","https://images.unsplash.com/photo-1600185365483-26d7a4cc7519?auto=format&fit=crop&w=1350&q=80","https://images.unsplash.com/photo-1552346154-21d32810aba3?auto=format&fit=crop&w=1350&q=80"],description:"Tenis deportivos con tecnología de amortiguación AirMax para máxima comodidad durante tus entrenamientos.",price:"$1,499",originalPrice:"$1,799"},{name:"Urban Flex 2023",badge:"",images:["https://images.unsplash.com/photo-1600269452121-4f2416e55c28?auto=format&fit=crop&w=1350&q=80","https://images.unsplash.com/photo-1542291026-7eec264c27ff?auto=format&fit=crop&w=1350&q=80","https://images.unsplash.com/photo-1600185365483-26d7a4cc7519?auto=format&fit=crop&w=1350&q=80","https://images.unsplash.com/photo-1552346154-21d32810aba3?auto=format&fit=crop&w=1350&q=80"],description:"Tenis ligeros y flexibles ideales para la ciudad.",price:"$1,499",originalPrice:"$1,799"}];function renderProducts(){const t=document.getElementById("products-grid"),e=document.getElementById("product-template");products.forEach(a=>{const o=e.content.cloneNode(!0),r=o.querySelector(".product-badge");a.badge?r.textContent=a.badge:r.remove();const n=o.querySelector(".product-main-image");n.src=a.images[0],n.alt=a.name,n.loading="lazy",n.srcset=`${a.images[0]}?w=300 300w, ${a.images[0]}?w=600 600w`,n.sizes="(max-width: 600px) 300px, 600px";const c=o.querySelector(".product-thumbnails");a.images.forEach((t,e)=>{const o=document.createElement("img");o.src=t,o.alt=`${a.name} miniatura ${e+1}`,o.className="product-thumbnail",o.loading="lazy",o.srcset=`${t}?w=150 150w, ${t}?w=300 300w`,o.sizes="(max-width: 600px) 150px, 300px",c.appendChild(o)}),o.querySelector("h3").textContent=a.name,o.querySelector(".product-description").textContent=a.description;const l=o.querySelector(".size-select"),s=o.querySelector(".size-label"),i=`size-${a.name.replace(/\s+/g,"-")}`;l.id=i,s.setAttribute("for",i),s.textContent="Talla:";(tallasPorProducto[a.name]||[]).forEach(t=>{const e=document.createElement("option");e.value=t,e.textContent=t,l.appendChild(e)});const d=o.querySelector(".color-options");(coloresPorProducto[a.name]||[]).forEach(t=>{const e=document.createElement("div");e.className="color-option",e.dataset.color=t,e.style.backgroundColor=t,d.appendChild(e)}),o.querySelector(".price").textContent=a.price,o.querySelector(".original-price").textContent=a.originalPrice,t.appendChild(o)})}function throttle(t,e){let a=0;return function(...o){const r=Date.now();r-a>=e&&(a=r,t.apply(this,o))}}let cart=JSON.parse(localStorage.getItem("cart")||"[]");function updateCartCount(){document.getElementById("cart-count").textContent=cart.reduce((t,e)=>t+e.qty,0),localStorage.setItem("cart",JSON.stringify(cart))}function updateCartModal(){const t=document.getElementById("cart-items"),e=document.getElementById("cart-total");if(0===cart.length)return t.innerHTML="<p>El carrito está vacío.</p>",void(e.textContent="");t.innerHTML=cart.map((t,e)=>`<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;gap:10px;">\n      <span>${t.name} <span style="font-size:0.9em;color:#888;">(${t.color}, Talla: ${t.talla})</span></span>\n      <div style="display:flex;align-items:center;gap:5px;">\n        <button class="cart-qty-btn" data-idx="${e}" data-action="decrease" style="padding:2px 8px;">-</button>\n        <span>${t.qty}</span>\n        <button class="cart-qty-btn" data-idx="${e}" data-action="increase" style="padding:2px 8px;">+</button>\n      </div>\n      <span>${t.price}</span>\n      <button class="cart-remove-btn" data-idx="${e}" style="color:red;background:none;border:none;font-size:1.2rem;cursor:pointer;">&times;</button>\n    </div>`).join(""),t.querySelectorAll(".cart-qty-btn").forEach(t=>{t.addEventListener("click",function(){const t=parseInt(this.dataset.idx),e=this.dataset.action;"increase"===e&&(cart[t].qty+=1),"decrease"===e&&cart[t].qty>1&&(cart[t].qty-=1),updateCartCount(),updateCartModal()})}),t.querySelectorAll(".cart-remove-btn").forEach(t=>{t.addEventListener("click",function(){const t=parseInt(this.dataset.idx);cart.splice(t,1),updateCartCount(),updateCartModal()})});const a=cart.reduce((t,e)=>{let a=e.price.replace("$","").replace(",","");return t+(parseFloat(a)||0)*e.qty},0);e.textContent="Total: $"+a.toLocaleString()}document.addEventListener("DOMContentLoaded",()=>{renderProducts(),document.querySelectorAll(".product-thumbnails").forEach(t=>{t.children.length>0&&t.children[0].classList.add("active-thumbnail")}),document.addEventListener("click",t=>{if(t.target.classList.contains("product-thumbnail")){t.target.closest(".product-images").querySelector(".product-main-image").src=t.target.src,t.target.parentElement.querySelectorAll(".product-thumbnail").forEach(t=>t.classList.remove("active-thumbnail")),t.target.classList.add("active-thumbnail")}if(t.target.classList.contains("color-option")){t.target.parentElement.querySelectorAll(".color-option").forEach(t=>t.classList.remove("selected-color")),t.target.classList.add("selected-color")}}),document.querySelectorAll(".whatsapp-btn").forEach(t=>{t.addEventListener("click",function(){const t=this.closest(".product-card").querySelector("h3").textContent,e=this.closest(".product-price").querySelector(".price").textContent,a=`https://wa.me/1234567890?text=${encodeURIComponent(`¡Hola! Estoy interesado en comprar: ${t} (${e}). ¿Podrían darme más información?`)}`;window.open(a,"_blank")})}),document.querySelectorAll(".add-to-cart-btn").forEach(t=>{t.addEventListener("click",function(){const t=this.closest(".product-card"),e=t.querySelector("h3").textContent,a=t.querySelector(".price").textContent,o=t.querySelector(".size-select"),r=t.querySelector(".color-option.selected-color");if(!r)return void alert("Por favor selecciona un color antes de agregar al carrito.");if(!o.value)return void alert("Por favor selecciona una talla antes de agregar al carrito.");const n=r.dataset.color,c=o.value,l=cart.find(t=>t.name===e&&t.price===a&&t.color===n&&t.talla===c);l?l.qty+=1:cart.push({name:e,price:a,qty:1,color:n,talla:c}),updateCartCount()})}),document.getElementById("cart-link").addEventListener("click",t=>{t.preventDefault();const e=document.getElementById("cart-modal");e.style.display="flex",e.setAttribute("aria-hidden","false"),updateCartModal()}),document.getElementById("close-cart").addEventListener("click",()=>{const t=document.getElementById("cart-modal");t.style.display="none",t.setAttribute("aria-hidden","true")}),document.getElementById("send-cart-whatsapp").addEventListener("click",()=>{if(0===cart.length)return void alert("El carrito está vacío.");let t="¡Hola! Quiero comprar estos productos:%0A";cart.forEach(e=>{let a=e.color?`, Color: ${e.color}`:"",o=e.talla?`, Talla: ${e.talla}`:"",r=`${e.qty} unidad${e.qty>1?"es":""}`;t+=`• ${e.name} - ${r} (${e.price}${a}${o})%0A`});const e=cart.reduce((t,e)=>t+parseFloat(e.price.replace("$","").replace(",",""))*e.qty,0);t+=`%0ATotal: $${e.toLocaleString()}`;const a=`https://wa.me/522261032568?text=${t}`;window.open(a,"_blank")}),window.addEventListener("scroll",throttle(()=>{const t=document.querySelector("header");window.scrollY>100?t.classList.add("scrolled"):t.classList.remove("scrolled")},200));const t=document.getElementById("contact-form"),e=document.getElementById("form-message");t.addEventListener("submit",t=>{t.preventDefault(),e.textContent="Mensaje enviado correctamente."}),document.getElementById("current-year").textContent=(new Date).getFullYear(),updateCartCount()});